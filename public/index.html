<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>karsh | Secure Login</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Fira Code', monospace; }
  body {
    height:100vh; display:flex; justify-content:center; align-items:center;
    background-color:#0d0d17; color:#c5c6c7;
  }
  .login-container {
    background-color:#1c1c28; padding:40px 50px; border-radius:12px;
    box-shadow:0 0 30px rgba(0,0,0,0.6); text-align:center; width:100%; max-width:400px;
    animation:fadeIn 0.8s ease-out;
  }
  @keyframes fadeIn { from{opacity:0;transform:translateY(15px);} to{opacity:1;transform:translateY(0);} }
  h1 { color:#61dafb; margin-bottom:25px; font-size:2.1em; letter-spacing:1px; }
  .input-group { position: relative; }
  input[type="password"], input[type="text"] {
    width:100%; padding:14px 40px 14px 14px; margin-bottom:20px; border:none; border-radius:6px;
    background-color:#10101a; color:#c5c6c7; font-size:1em; outline:none; transition:0.2s;
  }
  input:focus { background-color:#19192a; box-shadow:0 0 6px #61dafb; }
  .toggle-password {
    position:absolute; right:10px; top:50%; transform:translateY(-50%);
    cursor:pointer; color:#61dafb; font-size:0.9em; user-select:none;
  }
  button {
    width:100%; padding:14px; border:none; border-radius:6px; background-color:#61dafb;
    color:#0d0d17; font-weight:bold; font-size:1em; cursor:pointer; transition:all 0.2s; display:flex;
    justify-content:center; align-items:center;
  }
  button:hover { background-color:#21a1f1; transform:translateY(-2px); }
  .spinner {
    border: 3px solid #f3f3f3; border-top: 3px solid #0d0d17; border-radius: 50%;
    width: 18px; height: 18px; animation: spin 0.8s linear infinite; margin-left:10px; display:none;
  }
  @keyframes spin { 0% { transform:rotate(0deg); } 100% { transform:rotate(360deg); } }
  p { margin-top:15px; font-size:0.85em; color:#777; }
</style>
</head>
<body>

<div class="login-container">
  <h1>Secure Access</h1>
  <div class="input-group">
    <input type="password" id="password" placeholder="Enter Password" maxlength="30">
    <span class="toggle-password" id="togglePassword">Show</span>
  </div>
  <button id="loginBtn">Access <div class="spinner" id="spinner"></div></button>
  <p>Â©2025 Powered by karsh Securities</p>
</div>

<script>
const input = document.getElementById("password");
const button = document.getElementById("loginBtn");
const spinner = document.getElementById("spinner");
const toggle = document.getElementById("togglePassword");

// Show/hide password toggle
toggle.addEventListener("click", () => {
  if(input.type === "password") { 
    input.type = "text"; toggle.textContent = "Hide"; 
  } else { 
    input.type = "password"; toggle.textContent = "Show"; 
  }
});

// Login function
async function login() {
  const password = input.value.trim();
  if(!password){ alert("Please enter your password."); return; }

  // Show spinner and disable button
  spinner.style.display = "inline-block";
  button.disabled = true;

  try {
    const res = await fetch("/verify", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      credentials:"include",
      body:JSON.stringify({ password })
    });
    const data = await res.json();
    input.value = "";
    spinner.style.display = "none";
    button.disabled = false;

    if(data.ok) {
      window.location.href = "/protected/";
    } else {
      alert("Access denied: Invalid password.");
    }
  } catch(err) {
    alert("Server unreachable. Try again later.");
    spinner.style.display = "none";
    button.disabled = false;
    input.value = "";
  }
}

button.addEventListener("click", login);
input.addEventListener("keydown",(e)=>{if(e.key==="Enter") login();});
</script>

</body>
</html>
